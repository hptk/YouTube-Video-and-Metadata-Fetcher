from RequestAbstraction import RequestAbstraction
import pprint
class YouTubeMetaFetcher(RequestAbstraction):
    
    def initWorkQueue(self):
        """initialize the working queue, normally doing some db query and get the ids of the videos for which you want to fetch the meta data
            in this case, it is just dummy data
        """
        """a better way would be to take 50 ids per queue item in order to make less requests """
        videoIDs = ["gb2qIS0bPpc", "I_AhhhcceXk", "ObbQEjShPAM", "G35kPhbUZdg", "kvEQeFd0Zy0", "ocO9cPlePbA", "DnxJyHUanpU", "fTYCNmFaD48", "4c-5XO4SgTg", "x7ZyEJUnX74", "6S1o4VhaoiM", "zKx2B8WCQuw", "mFK8i7HEDSo", "wKfbvwdvK3o", "4r0ZTN6ZoM4", "VA-sSQZFUnA", "7iGEXcteXBY", "EcG2Naoh18Q", "SuvCaxJf_Ag", "TV_X-9O8A2U", "9grWo5ZofmA", "PM7DrOZq0HE", "WIRbKydivrw", "fZO6LlxBB7g", "d3QD_cyNXck", "8aEngvXFEa4", "DgB8sRFc6gM", "uuFf3gecj8M", "WhHYM_NgiGY", "r5CgjDxkdf8", "ITFAPFrQAOs", "afIFTORTOKM", "rCm2mFk5xok", "0jHlCjXbgvA", "SOEW0wlFZ9E", "6dfz73m4Dzk", "sB93UsJ8AbQ", "saSMWyo_TpY", "Co0IUIOyNGU", "Bj3J3DfX_LI", "6L1aHP9KLgs", "lSh4fFqAW1U", "yNxAVw77-Uo", "UNs_eH6Z4ps", "VtxmypNYfM4", "tqmzh6gPfb4", "jCKbCIFzRrA", "ZzPU6Pdw05s", "Myl5qoM62BU", "1h-uzI_u_50", "nAJFzfPuxyA", "1xTOVasoBdU", "S9LK1U3_lcw", "iX21bKQmtlU", "iMfO4BDgfM8", "pIGy4R8J7Ks", "26cfuCLOqLk", "io80usj_Gbg", "D3O0dxClv9s", "WsveYepgEaw", "MYJkM4wfyZI", "M7h3OzQ0rQE", "J91S_297_PA", "Oe2s3Ti8yVA", "ehfH-Kb-2Zg", "_dtpFL53R4U", "1pFPZHOSwBo", "Wor19T1jEYw", "AZLC-D66YAk", "GCdUIkh8jqQ", "4fSf08hfBC8", "VTXRp0Tmvd8", "Y-fxow887s8", "5atYX3czB4I", "0ZXdHVaityY", "uQAukbxCWjw", "IqcxRdkAn1M", "jkJLQSgdYYQ", "qXDyERzzS18", "zlJhuRMxXJg", "dsQ6wjKmxd4", "As6qx7eol64", "wMoOfIzgSuw", "Str2QAqVYh0", "vQp8jjrUOVU", "rY50fjaw8og", "0mN8Y_ewY2g", "Ig5zxvOXRMk", "ESXtNoDUBW0", "b5tMomhjGKY", "IwPcZM9-OLc", "0hi1pBMFP9Y", "vyZvQx4xpOQ", "9P7jXveokDY", "HNHncZKGCkI", "wOJPb53H290", "MPzcjwGcAWM", "btyB4ateha0", "f8UkTsgs4gc", "3F7Ct4tLejU", "ARGAxpmFw-I", "WGueX4VD5pc", "0L-ukd_lI-I", "ivsNyo52DI8", "mOWbBf6ZbuU", "S-JMnPlKpjM", "Dc8fHCmuAJo", "TMY0iTcspNA", "qaE7Ot3i2ak", "eeVmpRqfv08", "QQ3E72-PcP8", "gycp8HZVpa4", "7bT9W2RCv1E", "qJ--oZJQd_c", "BgxQDJRUL5Q", "5dAjwC8QP6k", "uYSN3aaZX48", "VSbJeiJQMiU", "jbu6I-8mNUo", "DnFSwDubGRc", "vcL1kindj4I", "DZaZkbejaJA", "SMUYAX5dhlM", "fKicB3HP5G0", "UmT1UsUtwHI", "rfOMqehl-ZA", "_b8SqTQ4_74", "YMHHts_8LNc", "Lwmpc2xxJzI", "XZmgqEvZvPI", "5-L-UYTyFBU", "El2o0YnzILQ", "6Me6ENg0vYM", "jO_TbbZheq4", "J4Rj8MdJ7aQ", "Z8SSiVnPIHE", "hToywIY5V7A", "hfwluW7sT34", "bsZl4_pm5OI", "39DfLYyV5aU", "Mi12ZQr_bw8", "3RvjSThUb9g", "wh0iuZxSz7Q", "iWX-7KFqrJ4", "UTZHA5Z4Va0", "ZjbNVgLCa0Q", "snz7JJlSZvw", "isZMvzFdFOg", "ZHX1IZxAF9Y", "mVLlrVelnl4", "8sPUM6QnTOI", "RMza1g5Cyhc", "sb2xOeD4vsI", "qXN4MaYuI5U", "2i6hwnZi99w", "z9OkefcFZII", "9ZJAa4ny3pY", "IgsHuaS8G84", "UXP4ogvYgqQ", "GsE1wnDjEq8", "Kk3L382aed8", "gh_t-ktAuZU", "f_4Ua7VWyBA", "DTTMDQNhLuk", "gBl2tWJA4Y4", "acOZT240bTA", "pO4SckGsCGM", "EUWRIDjyCZw", "Nb0dx2jHvKk", "hz9NQ6qEVr0", "uVnu7tiONBc", "X8R4Eu-6tAg", "KsZyfTPZcFI", "RkfmyhcR2lk", "vfbXxZrFcWc", "esbhie1dBX4", "TfFH7FGRTEA", "EOIelkzB7-I", "3oJAddoXtGQ", "U94WWN7QMK4", "VLbz9rmk5ZA", "sTdmzLv30AI", "hsa_LofMrGE", "ku1vdrWQuJY", "byDsjf9LwPk", "eHBhRJS2bQQ", "uhdUW4dbQLo", "q4AQDDKglEE", "nSe1cEYIx_s", "4uXxs9B1qKQ", "g0UW6WFCOiI", "5o-ReJAzDfM", "onQ7VcmGSZQ", "gqvMm_Mwm-o", "00SH5Mq9J-U", "eG0-jl9tzmw", "YQjK53qdKoU", "_e99guylGFI", "vwdo0mmmb8I", "aXaTiBZnX2w", "nwja8Ff6DDo", "imyCoWWmIC8", "scSIzFxRkDM", "64md75JrPIs", "xRW88bKWkrM", "PbRgTRSdBLg", "wqoRacMuD-g", "SOZWc8CDFig", "6Tqd4hv7Dao", "gwYIyjwYluc", "i9o_bG0PVEI", "3odgthPcfKM", "SwUlcKCC_kM", "7rFDC9T0Aps", "5oAbhwC8LZI", "na4b3apWAl0", "x_siRlWTLIA", "wKcrnVJewfY", "mA7YR0qnwn0", "UlSTs1NuqCE", "CVISHyinXi4", "08pt5jzyD9Y", "_30Z6qxnydE", "HXuq1j9FOY0", "YiDB2EHWUQA", "VCcp7IY7qj8", "zhug0r8mdIQ", "TuVPYZ9lcAE", "j4pp_saaEbQ", "2XIjJqCgNOA", "okup-d5rmOM", "kjdLatKLo1k", "U0FT0oYx4Vg", "M27Fgk1iJ24", "iKyw01xsZDg", "x4FVJT1PTIA", "IsPS5rIa0Ao", "nnCrnWOiKG4", "B8qfx_xs8JM", "wFE01-mL430", "_kCAqifT20s", "o5M2SZweYDw", "AoJ8NGImz2A", "YQgh3F6y1pE", "qOvm4spF6Cc", "mJvdl8ABA6U", "q0_04uePRnw", "4pj07RbBGyI", "-v4aKWaDisY", "5jpbocfn7SM", "H3aZSEPIyZs", "LimyJDAeDcE", "ZQ9YiMp625o", "IyTpZWxVqvI", "BbzaAOBiNgQ", "rBicCZG4vg0", "d1kw1RmzrPc", "pIXTZ0SMgTE", "hgkzE0YGxTo", "xjaQcowLhPo", "tXCuMAqGvZE", "8z5L9idk6tk", "sHaAWtjLgu0", "sAexKR4KvuM", "G8bmNHYnbIM", "p8KH8FW-mFA", "veXLjfD2Gpw", "TjCGWIFKw-0", "ENhCkK2hYxA", "0DrY-wNfntQ", "S7qZRbbfraw", "eHJ2FrHSkIg", "J8Xy_MqjsgU", "MnudGSHUJ8o", "Muw_L5O7Ji0", "VGBs05NINbY", "g6Qk5aj3uik", "1wxOxuitvEM", "F06TuzQdF74", "OKr-9WJTHME", "Ru9lEijA3Ag", "Bo3ZcxNlyqY", "fkaekKxfSc4", "atMuFCpxnUQ", "Si-oHDlt4NQ", "TMwu5j2-bHo", "jle1g8eeOgw", "vMRr49ReDo4", "ArRChl4OP08", "JXaukctamdQ", "9kK9L62jx24", "IGZ5XtR-BP4", "DTQ_K76zEIM", "WSd5eeNTYn4", "DjLf4-Hjrxw", "0lUYPz01x-s", "F97ab6u8eD8", "S4RLaHdbXqg", "9-ROmGsYKr0", "5Upjp-B-C28", "0hXSKgUmAYQ", "RQ7vW1M3J8E", "2xwxxZ1Vjz0", "hSq2Pb8dZ54", "0c4xk5dB014", "bQITkw5Vbeg", "dOyJqGtP-wU", "nDRK1nsp_8c", "PBzEwf1k59Y", "u1gYmxLr-Lg", "H6cOHoc3MYw", "FhUquu6lUU4", "ypaxe2F5cLc", "cUnlKoia7vg", "Z7d1hj5_8Ic", "1nu8LK8DeyI", "5AVC-e7p5k8", "2l0BAOqBp08", "KST48nioRbc", "SexECgg6_w0", "A2r3msYEyYU", "2b7EQi-4BmA", "KsgZDIORIW0", "kWEUL8-SqqA", "cGy7UkhKPJg", "A4YdJNMugpk", "fz14DBP7Er8", "5meC4Z61qGg", "pimzw_jbtho", "Qc25Ewq9QBI", "Xj0tImGVmsk", "5Qfah7iExUY", "EakuJxAbM0k", "Y-F88ZE_JGU", "tndabJ7anUI", "qWjMoWAuAiI", "ZnrKKjaVxCA", "RXI5C2OER4Y", "TgNL4Ss1zVM", "-Pdk-WKvpho", "gvodQf-FDzg", "jD6OL6epby4", "13PVFuRC_T4", "H5jQhjLKfiQ", "TfAN6HMS0Vk", "W0BC9KBNGSs", "95KTrtzOY-g", "n1HSx2JFqXw", "iaGvNHmtaf4", "xrHNxAhA7mA", "8DnAINSAo8A", "k0AmejaZljY", "h7Vcbftbsks", "3hqnYWORDTY", "BoGBBWw6Dw0", "FQTil6gm-50", "BoAsJq8GUCs", "K4va0x3lhSk", "xRALXD8JF68", "ORHtpr8nm4E", "IKsTFcoeDes", "zFdHmhIR0b0", "-L1q3vQmwmA", "kE7kVjeBM-U", "Cf1N9WI-9qg", "8CYGisE2Fvo", "J7cWj3HErjk", "lqgbq_Q998w", "SbCblXoJ4Yk", "rqJCeWCHHIM", "R_rTA63eGls", "jtimZCzmioQ", "g8HyLRdKSyo", "BYb73iiTBEA", "JNUMMhjgmC0", "Db_m_jBHUlw", "1F6IQaICCAY", "ICnQr9o4g9g", "0z-4zUp3ksE", "Pvz07vHspzk", "hI0Ee81epXM", "6WbxlLS6i-o", "IT__vQcPftM", "2tEtgBRoUbg", "w0NZlvXR0jc", "QiZsUriYcBw", "2EUbDbhjOyY", "dSZLmIvy80s", "wKepIpicYgM", "Vr5K5jjVWbs", "EdQ7JPDf4n8", "V8Io5qEmdug", "rhlmlAUFayc", "3ZpsYKALq10", "JVwwx-3gA6c", "6PAyR1e4OWQ", "psI69rzAmfI", "Tcp4Jr4rRcA", "cgO7q5t-QAE", "UDn7309I9YY", "3yR-9i1vV7Y", "gf1wA_YBmyM", "8V17dGh7Xho", "VPPfXsYocfw", "a1OvimyDp6Y", "GxCMRPnvCvY", "aDX2jTL3tZw", "tyLPkVp6Z2A", "XLhlY61ho-Y", "gAvy2vGl5gI", "Yjr0R0jgct4", "9XcEo7aL67I", "DsJYU3FOZNA", "x0GZpgXXSpo", "87b2j1K7WhQ", "Q3kQwWU_deg", "bRY3n6IFnEM", "izO2_mCvFaw", "tOikNIREDaU", "XJMLVTFRaIw", "8mcJghE4nh4", "0DI3cmk1p5A", "bN_C4V5J014", "ZjwOJ8MWnXQ", "OAQdG0CVZSQ", "sOxbIeMaOu8", "ZmngcheT320", "YgfaBJwpShY"];
        for id in videoIDs:
            self.putWorkQueueItem(id)
            
    def buildRequestURL(self, workQueueItem):
        videoID = workQueueItem
        return self.url+"?part=contentDetails,status,recordingDetails,topicDetails,statistics,snippet&id="+videoID+"&fields=items(ageGating,contentDetails,conversionPings,etag,fileDetails,kind,liveStreamingDetails,localizations,monetizationDetails,player,processingDetails,projectDetails,recordingDetails,snippet,statistics,status,suggestions,topicDetails)&key=AIzaSyBlO0GfmL5LuRJoVlRhMVM8VjViE5BAAs8"
    
    def handleRequestSuccess(self,workQueueItem, result):
        if "items" in result:
            for item in result['items']:
                print item['snippet']['title']
    
    
db_reference = None 
test = YouTubeMetaFetcher("https://www.googleapis.com/youtube/v3/videos",db_reference,50,50)
pprint.pprint(test.work())